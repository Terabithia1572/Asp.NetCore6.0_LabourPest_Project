
<div class="ds col-lg-6 py-lg-0 py-md-90 py-60 faq-contact column-overlay d-flex align-items-center">
	<div class="content-center">
		<br/>
		<br/>
		<br/>
		<h4 class="special-heading text-center text-capitalize">Lütfen bizimle yorumlarınızı paylaşın !</h4>
		<div class="divider-50 hidden-below-md"></div>
		<div class="divider-35 hidden-above-md"></div>
		<form class="contact-form c-mb-40 c-gutter-20" method="post" asp-action="AddComment" asp-controller="MainComment">

			<div class="row">
				<div class="col-sm-12">
					<div class="form-group has-placeholder col-sm-6">
						<label for="1">Adınız Soyadınız <span class="required">*</span></label>

						<input type="text" aria-required="true" size="30" value="" name="CommentUserName" id="1" class="form-control" placeholder="ADINIZ SOYADINIZ">
					</div>
					<div class="form-group has-placeholder col-sm-6">
						<label for="2">Adınız Soyadınız <span class="required">*</span></label>

						<input type="text" aria-required="true" size="30" value="" name="CommentTitle" id="2" class="form-control" placeholder="KONU">
					</div>
				</div>
				
				<div class="dropzone dropzone-multiple p-0 mb-5" id="my-awesome-dropzone" data-dropzone="data-dropzone">
					<!-- Fallback input for file selection -->
					<div class="fallback ">
                        <input name="file" type="file" multiple="multiple" onchange="uploadProfileImage(event)" />
					</div>
				<br />
					<div class="dz-message text-body-tertiary text-opacity-85" data-dz-message="data-dz-message">
						veya Fotoğrafı Buraya Sürükle
						<span class="text-body-secondary px-1"></span>
						<button class="btn btn-link p-0" type="button"></button><br />
						<img class="mt-3 me-2" src="~/labourpestcustomer/assets/img/icons/image-icon.png" width="40" alt="" />
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-12 mb-0">
					<div class="form-group has-placeholder">
						<label for="message">Mesajınız</label>
						<textarea aria-required="true" rows="3" cols="45" name="CommentContent" id="message" class="form-control" placeholder="YORUMUNUZ"></textarea>
					</div>
				</div>
			</div>
            <div class="col-sm-6 col-md-4" style="display: none" >
                <div class="form-floating"><input class="form-control" id="floatingInputTitle" type="text" placeholder="title" name="ImageURL" /><label for="floatingInputTitle">RESİM</label></div>
            </div>
			<div class="row">
				<div class="col-sm-12 text-center">
					<div class="form-group">
						<input class="btn btn-maincolor" type="submit" value="Gönder">
					</div>
				</div>
			</div>
		</form>
	</div>
</div>

<script>
    async function uploadProfileImage(event) {
        const file = event.target.files[0];
        if (file) {
            const formData = new FormData();
            formData.append('file', file);

            // Gönderim
            const response = await fetch('/MainComment/UploadImage', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                const result = await response.json();
                document.getElementById('floatingInputTitle').value = result.filePath;
                document.getElementById('preview-avatar').src = result.filePath;
            } else {
                alert('Resim yüklenirken bir hata oluştu!');
            }
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        const dropzone = document.getElementById('my-awesome-dropzone');

        // Sürükle-bırak olaylarını engelle
        dropzone.addEventListener('dragover', (event) => {
            event.preventDefault();
            event.stopPropagation();
            dropzone.classList.add('dragging');
        });

        dropzone.addEventListener('dragleave', (event) => {
            event.preventDefault();
            event.stopPropagation();
            dropzone.classList.remove('dragging');
        });

        dropzone.addEventListener('drop', async (event) => {
            event.preventDefault();
            event.stopPropagation();
            dropzone.classList.remove('dragging');

            const files = event.dataTransfer.files;

            if (files.length > 0) {
                const file = files[0];
                const formData = new FormData();
                formData.append('file', file);

                try {
                    const response = await fetch('/MainComment/UploadImage', {
                        method: 'POST',
                        body: formData,
                    });

                    if (response.ok) {
                        const result = await response.json();
                        document.getElementById('floatingInputTitle').value = result.filePath;

                    } else {
                        alert('Resim yüklenirken bir hata oluştu!');
                    }
                } catch (error) {
                    console.error('Upload error:', error);
                    alert('Resim yüklenirken bir hata oluştu!');
                }
            }
        });
    });
</script>